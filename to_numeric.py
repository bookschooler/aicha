import pandas as pd
import os

# 1. íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
current_folder = os.path.dirname(os.path.abspath(__file__))
file_name = "seoul_cafe_sales.csv" # ì˜í”¼ íŒŒì¼ ì´ë¦„
file_path = os.path.join(current_folder, file_name)

df = pd.read_csv(file_path)

# ------------------------------------------------------------------
# ğŸ©º [Before] ë³€í™˜ ì „ ìƒíƒœ í™•ì¸ (Dtypeì´ objectë©´ ë¬¸ìì—´ì´ë¼ëŠ” ëœ»)
# ------------------------------------------------------------------
print("=== ë³€í™˜ ì „ ë°ì´í„° íƒ€ì… (object=ê¸€ì) ===")
print(df.info()) 

# ------------------------------------------------------------------
# âš¡ [í•µì‹¬] ì „ì²´ ì»¬ëŸ¼ì„ ëŒë©´ì„œ ìˆ«ìë¡œ ë³€í™˜ ì‹œë„!
# ------------------------------------------------------------------
# errors='ignore': "ìˆ«ìë¡œ ëª» ë°”ê¾¸ëŠ” ê±°(ì˜ˆ: 'ê°•ë‚¨êµ¬')ëŠ” ì—ëŸ¬ ë‚´ì§€ ë§ê³  ê·¸ëƒ¥ ë‘¬ë¼"
# apply(pd.to_numeric): ëª¨ë“  ì»¬ëŸ¼ì— ëŒ€í•´ to_numeric í•¨ìˆ˜ë¥¼ ì ìš©í•´ë¼
df = df.apply(pd.to_numeric, errors='ignore')

# ------------------------------------------------------------------
# ğŸ¥ [After] ë³€í™˜ í›„ ìƒíƒœ í™•ì¸ (int64, float64ë©´ ì„±ê³µ!)
# ------------------------------------------------------------------
print("\n" + "="*50)
print("=== ì§ ! ë³€í™˜ í›„ ë°ì´í„° íƒ€ì… (int/float=ìˆ«ì) ===")
print(df.info()) 

# ------------------------------------------------------------------
# ì´ì œ ì˜í”¼ê°€ ì›í–ˆë˜ í•„í„°ë§ & ê³„ì‚° ì‘ì—…ì„ ì—¬ê¸°ì„œë¶€í„° ì‹œì‘í•˜ë©´ ë¼!
# ------------------------------------------------------------------
# ì˜ˆ: ì»¤í”¼ ë°ì´í„°ë§Œ ë‚¨ê¸°ê¸°
coffee_df = df[df['SVC_INDUTY_CD_NM'] == 'ì»¤í”¼-ìŒë£Œ']

# ì €ì¥í•´ë‘ë©´ ë‚˜ì¤‘ì—” í¸í•˜ê² ì§€?
coffee_df.to_csv("cafe_sales_to_numeric.csv", index=False, encoding="utf-8-sig")